<!DOCTYPE html>
<html>
<body style="background-color:powderblue;">

<table>
<tr>
    <td>
        <svg id="board" width="700" height="700">
            <circle id="c0" cx="100" cy="50" r="40" /> <circle id="c1" cx="100" cy="50" r="40" /> <circle id="c2" cx="100" cy="50" r="40" />
            <circle id="c3" cx="100" cy="50" r="40" /> <circle id="c4" cx="100" cy="50" r="40" /> <circle id="c5" cx="100" cy="50" r="40" />
            <circle id="c6" cx="100" cy="50" r="40" /> <circle id="c7" cx="100" cy="50" r="40" /> <circle id="c8" cx="100" cy="50" r="40" />
            <circle id="c9" cx="100" cy="50" r="40" /> <circle id="c10" cx="100" cy="50" r="40" /> <circle id="c11" cx="100" cy="50" r="40" />
            <circle id="c12" cx="100" cy="50" r="40" /> <circle id="c13" cx="100" cy="50" r="40" /> <circle id="c14" cx="100" cy="50" r="40" />
            <circle id="c15" cx="100" cy="50" r="40" /> <circle id="c16" cx="100" cy="50" r="40" /> <circle id="c17" cx="100" cy="50" r="40" />
            <circle id="c18" cx="100" cy="50" r="40" /> <circle id="c19" cx="100" cy="50" r="40" /> <circle id="c20" cx="100" cy="50" r="40" />
            <circle id="c21" cx="100" cy="50" r="40" /> <circle id="c22" cx="100" cy="50" r="40" /> <circle id="c23" cx="100" cy="50" r="40" />
            <circle id="c24" cx="100" cy="50" r="40" /> <circle id="c25" cx="100" cy="50" r="40" /> <circle id="c26" cx="100" cy="50" r="40" />
            <circle id="c27" cx="100" cy="50" r="40" /> <circle id="c28" cx="100" cy="50" r="40" /> <circle id="c29" cx="100" cy="50" r="40" />
            <circle id="c30" cx="100" cy="50" r="40" /> <circle id="c31" cx="100" cy="50" r="40" /> <circle id="c32" cx="100" cy="50" r="40" />
            <circle id="c33" cx="100" cy="50" r="40" /> <circle id="c34" cx="100" cy="50" r="40" /> <circle id="c35" cx="100" cy="50" r="40" />
            <circle id="c36" cx="100" cy="50" r="40" /> <circle id="c37" cx="100" cy="50" r="40" /> <circle id="c38" cx="100" cy="50" r="40" />
            <circle id="c39" cx="100" cy="50" r="40" /> <circle id="c40" cx="100" cy="50" r="40" /> <circle id="c41" cx="100" cy="50" r="40" />
            <circle id="c42" cx="100" cy="50" r="40" /> <circle id="c43" cx="100" cy="50" r="40" /> <circle id="c44" cx="100" cy="50" r="40" />
            <circle id="c45" cx="100" cy="50" r="40" /> <circle id="c46" cx="100" cy="50" r="40" /> <circle id="c47" cx="100" cy="50" r="40" />
            <circle id="c48" cx="100" cy="50" r="40" /> <circle id="c49" cx="100" cy="50" r="40" /> <circle id="c50" cx="100" cy="50" r="40" />
            <circle id="c51" cx="100" cy="50" r="40" /> <circle id="c52" cx="100" cy="50" r="40" /> <circle id="c53" cx="100" cy="50" r="40" />
            <circle id="c54" cx="100" cy="50" r="40" /> <circle id="c55" cx="100" cy="50" r="40" /> <circle id="c56" cx="100" cy="50" r="40" />
            <circle id="c57" cx="100" cy="50" r="40" /> <circle id="c58" cx="100" cy="50" r="40" /> <circle id="c59" cx="100" cy="50" r="40" />
            <circle id="c60" cx="100" cy="50" r="40" /> <circle id="c61" cx="100" cy="50" r="40" /> <circle id="c62" cx="100" cy="50" r="40" />
            <circle id="c63" cx="100" cy="50" r="40" /> <circle id="c64" cx="100" cy="50" r="40" /> <circle id="c65" cx="100" cy="50" r="40" />
            <circle id="c66" cx="100" cy="50" r="40" /> <circle id="c67" cx="100" cy="50" r="40" /> <circle id="c68" cx="100" cy="50" r="40" />
            <circle id="c69" cx="100" cy="50" r="40" /> <circle id="c70" cx="100" cy="50" r="40" /> <circle id="c71" cx="100" cy="50" r="40" />
            <circle id="c72" cx="100" cy="50" r="40" /> <circle id="c73" cx="100" cy="50" r="40" /> <circle id="c74" cx="100" cy="50" r="40" />
            <circle id="c75" cx="100" cy="50" r="40" /> <circle id="c76" cx="100" cy="50" r="40" /> <circle id="c77" cx="100" cy="50" r="40" />
            <circle id="c78" cx="100" cy="50" r="40" /> <circle id="c79" cx="100" cy="50" r="40" /> <circle id="c80" cx="100" cy="50" r="40" />
            <circle id="c81" cx="100" cy="50" r="40" /> <circle id="c82" cx="100" cy="50" r="40" /> <circle id="c83" cx="100" cy="50" r="40" />
            <circle id="c84" cx="100" cy="50" r="40" /> <circle id="c85" cx="100" cy="50" r="40" /> <circle id="c86" cx="100" cy="50" r="40" />
            <circle id="c87" cx="100" cy="50" r="40" /> <circle id="c88" cx="100" cy="50" r="40" /> <circle id="c89" cx="100" cy="50" r="40" />
            <circle id="c90" cx="100" cy="50" r="40" /> <circle id="c91" cx="100" cy="50" r="40" /> <circle id="c92" cx="100" cy="50" r="40" />
            <circle id="c93" cx="100" cy="50" r="40" /> <circle id="c94" cx="100" cy="50" r="40" /> <circle id="c95" cx="100" cy="50" r="40" />
            <circle id="c96" cx="100" cy="50" r="40" /> <circle id="c97" cx="100" cy="50" r="40" /> <circle id="c98" cx="100" cy="50" r="40" />
            Sorry, your browser does not support inline SVG.
        </svg>
    </td>
    <td>
        <div id="output"></div>
    </td>
</tr>
</table>

<script >
    // --------------------------- UTILITIES---------------------------------
    // Set up log
    const output = document.getElementById("output");

    const logAppend = (msg) => { } // Turn off logging
    // const logAppend = (msg) => { output.innerHTML += msg; } // Turn on logging

    const logLine = (msg) => logAppend(msg + "<br/>");
    logLine("Messages:");

    //--------------------------- SVG CONTROL -------------------------------
    const ringThickness = 12;
    var elements=[];

    // -- Functions -- //
    const clearFill = (element) => element.setAttribute("fill-opacity", "0");
    logLine(`Function clearFill defined`);

    const fillElement = (element, color) => {
        logAppend(`Filling ${element.id} with ${color}...`);
        element.setAttribute("fill-opacity", "1.0");
        element.setAttribute("fill", color);
        logLine(' done')
    }
    logLine(`Function fillElement defined`);

    const fillWhite = (element) => fillElement(element, "white");
    const fillGrey = (element) => fillElement(element, "lightgrey");
    const fillBlack = (element) => fillElement(element, "black");
    logLine('Functions defined for filling specific colors');

    const clearRing = (element) => element.setAttribute("stroke-opacity", "0");
    logLine('Function clearRing defined');

    const colorRing = (element, color) => {
        logAppend(`Setting ring ${element.id} to ${color}...`);
        element.setAttribute("stroke", color);
        element.setAttribute("stroke-opacity", "1.0");
        element.setAttribute("stroke-width", `${ringThickness}`);
        logLine(' done')
    }
    logLine('Function colorRing defined');

    const showRing = (element) => colorRing(element, "slategrey");
    logLine('Function showRing defined');

    const setCenter = (element, x, y) => {
        logAppend(`Moving ring ${element.id} to (${x}, ${y})... `)
        element.setAttribute("cx", `${x}`);
        element.setAttribute("cy", `${y}`);
        logLine(' done')
    }
    logLine('Function setCenter defined');

    const svgInit = () => {
        const xInc=100;
        const yInc=87;
        const rowLengths=[4, 5, 6, 7, 6, 5, 4];
        const ballColors = ["white", "grey", "black"]
        const ballCounts = [6, 8, 10];
        const numCircles = 99;
        var xInit=50;
        var x=xInit;
        var y=x;
        var numRows = rowLengths.length;
        var maxRowLength = Math.max(...rowLengths);
        var numBoardPositions = rowLengths.reduce((sum, x) => sum+x);
        var board = document.getElementById("board");

        logLine(`Setting board size`);
        board.setAttribute("width", `${Math.max(...ballCounts, maxRowLength)*xInc}`);
        board.setAttribute("height", `${(5+numRows) * yInc}`);
        // board.setAttribute("width", `${xInit + xInc*maxRowLength + xinc}`);
        // board.setAttribute("height", `${y + yInc*(numRows + 5) + xinc}`);

        // Collect circle elements
        logAppend(`Finding circle elements:`);
        for (var i=0; i < numCircles; i++) {
            logAppend(`c${i}?`);
            elements[i] = document.getElementById(`c${i}`);
            logAppend('!, ');
        }
        logLine('');
        logLine(`Found ${elements.length} circle elements`);

        // Place circles on board
        logLine(`Placing circles`);
        var i = 0;
        for (var row=0; row<numRows; row++) {
            logAppend(`Row ${row}: `);
            y = 50 + yInc*row;
            xInit = 50 + xInc * Math.abs(maxRowLength - rowLengths[row])/2; // integer division used to offset odd rows
            logLine(`xInit=${xInit}, y=${y}`);
            for (var position=0; position<rowLengths[row]; position++) {
                x = xInit + position * xInc;
                logLine(`   Position ${position}: x=${x}`);
                setCenter(elements[i], x, y);
                showRing(elements[i]);
                clearFill(elements[i]);
                i++;
            }
        }

        logLine(`Placing spare balls`);
        y = (numRows + 2) * yInc;
        for (var b = 0; b < ballCounts.length; b++){
            x = 50;
            for (var j = 0; j < ballCounts[b]; j++) {
                logLine(`   Ball ${j} (c${i}): (${x}, ${y})`);
                setCenter(elements[i], x, y);
                clearRing(elements[i]);
                fillElement(elements[i], ballColors[b]);
                x += xInc;
                i++;
            }
            y += yInc;
        }

        // Hide other circles
        logAppend(`Hiding circles: `);
        for (; i < numCircles; i++) {
            logAppend(`c${i}`);
            clearRing(elements[i]);
            clearFill(elements[i]);
            logAppend(`!, `);
        }
        logLine('');
    }

    // -------------------------------- TESTS ------------------------------------
    const runTests = () => {
        logLine("Beginning tests...");
        clearFill(elements[0]);
        fillElement(elements[1], "red");
        fillWhite(elements[2]);
        fillGrey(elements[3]);
        fillBlack(elements[4]);

        clearRing(elements[5]);
        colorRing(elements[6], "green");
        clearRing(elements[8]);
        showRing(elements[8]);
        fillGrey(elements[8]);

        setCenter(elements[9], 0, 0);
    }

    // -------------------------- MAIN --------------------------------------
    svgInit();
    // runTests();

</script>
</body>
</html>

